ğŸ’¾ Logging aktiv: 20250618_1832_verarbeitung_log.txt
ğŸ§ª Aktive Version: Patchstand 20250618_1445
ğŸ” Starte Verarbeitung mit Zwischenspeicherung und Batch-Limit...
ğŸ“‚ 3 Dateien gefunden.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âï¸ 1/3: DE51BNOM9AEUI.pdf
ğŸ›‚ Starte VorprÃ¼fung der Datei
ğŸ” Textlayer vorhanden: NEIN
âš ï¸ Kein brauchbarer Text erkannt â€“ wechsle zu GPT-OCR
ğŸ”  Starte GPT-Klassifikation auf Bildbasis (OCR)
ğŸ“¤ Sende Bild direkt an GPT zur Inhaltsextraktion â€¦
ğŸ“¤ Sende Bild an GPT zur Inhaltsextraktion â€¦
âœ… Starte PlausibilitÃ¤tsprÃ¼fung der Tabelle â€¦


âï¸ 2/3: DE56GWMABEC.pdf
ğŸ›‚ Starte VorprÃ¼fung der Datei
ğŸ” Textlayer vorhanden: NEIN
âš ï¸ Kein brauchbarer Text erkannt â€“ wechsle zu GPT-OCR
ğŸ”  Starte GPT-Klassifikation auf Bildbasis (OCR)
ğŸ“¤ Sende Bild direkt an GPT zur Inhaltsextraktion â€¦
ğŸ“¤ Sende Bild an GPT zur Inhaltsextraktion â€¦
âœ… Starte PlausibilitÃ¤tsprÃ¼fung der Tabelle â€¦


âï¸ 3/3: DE_25022865_073835.pdf
ğŸ›‚ Starte VorprÃ¼fung der Datei
ğŸ” Textlayer vorhanden: JA
ğŸ”  Starte GPT-Klassifikation auf Textbasis
ğŸ“¤ Sende Bild direkt an GPT zur Inhaltsextraktion â€¦
ğŸ“¤ Sende Text an GPT zur Inhaltsextraktion â€¦
âœ… Starte PlausibilitÃ¤tsprÃ¼fung der Tabelle â€¦


ğŸ”§ Harmonisiere Einheiten & Artikelbezeichnungen mit Mapping + Logging ...
ğŸ“„ Mapping-Datei nicht gefunden â€“ leeres Template wird angelegt: mein_mapping.xlsx
ğŸ“„ Mapping-Datei geladen: mein_mapping.xlsx
ğŸ§  Formatiere und korrigiere Zahlen â€¦
ğŸ§  Starte globale Artikel-Kategorisierung mit GPT und Log-Wiederverwendung â€¦

âŒ Fehler in 'Kategorisierung':
Traceback (most recent call last):
  File "C:\Users\Sascha.Detke\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Artikelbezeichnung'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Sascha.Detke\OneDrive - Seier Gruppe\Dokumente\RechnungsExtraktionKI\main.py", line 122, in sicher_ausfÃ¼hren
    return funktion(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sascha.Detke\OneDrive - Seier Gruppe\Dokumente\RechnungsExtraktionKI\main.py", line 358, in kategorisiere_artikel_global
    artikel = df["Artikelbezeichnung"].dropna().unique()
              ~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sascha.Detke\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sascha.Detke\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Artikelbezeichnung'



â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸŒŸ Verarbeitung beendet: 3 Dateien in 19.5s

ğŸ“Š Verarbeitungsstatistik:

ğŸ“œ Ã˜/Datei: 6.49s
ğŸ“„ Textbasiert: 1 (33.3%), Ã˜ 0.00s
ğŸ§  GPT-OCR: 2 (66.7%), Ã˜ 0.00s
âŒ Nicht-Rechnungen: 0 (0.0%)
âš ï¸ Probleme: 0 (0.0%)

ğŸ§¾ Zusammenfassung nach Skriptlauf:
âš ï¸ Es sind folgende Fehler aufgetreten:

âŒ Fehler in 'Kategorisierung':
Traceback (most recent call last):
  File "C:\Users\Sascha.Detke\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Artikelbezeichnung'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Sascha.Detke\OneDrive - Seier Gruppe\Dokumente\RechnungsExtraktionKI\main.py", line 122, in sicher_ausfÃ¼hren
    return funktion(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sascha.Detke\OneDrive - Seier Gruppe\Dokumente\RechnungsExtraktionKI\main.py", line 358, in kategorisiere_artikel_global
    artikel = df["Artikelbezeichnung"].dropna().unique()
              ~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sascha.Detke\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sascha.Detke\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Artikelbezeichnung'

âŒ Kategorisierung schlug fehl. Verarbeitung abgebrochen.

ğŸ“‹ Bitte behebe die Fehler und starte das Skript erneut.

âŒ Kritischer Fehler erkannt: Verarbeitung wurde bewusst abgebrochen.
ğŸ“‹ Bitte Ursache beheben (siehe 20250618_1832_fehlerprotokoll.txt), dann erneut starten.
